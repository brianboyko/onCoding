<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/onCoding/component---src-layouts-index-js-0e6e7990ee8dd50dc3f2.js" as="script"/><link rel="preload" href="/onCoding/component---src-templates-blog-template-js-3c042b543a488014fe7b.js" as="script"/><link rel="preload" href="/onCoding/path---blog-the-hip-ae7896d9acf4cd9e06e7.js" as="script"/><link rel="preload" href="/onCoding/app-c4f76d6e4cae8f6a822c.js" as="script"/><link rel="preload" href="/onCoding/commons-8dcba3f9452ce054e0e3.js" as="script"/><title data-react-helmet="true">Brian Boyko (On Coding)</title><link data-react-helmet="true" href="https://fonts.googleapis.com/css?family=Fjalla+One|Inconsolata|Sorts+Mill+Goudy" rel="stylesheet"/><meta data-react-helmet="true" name="description" content="Sample"/><meta data-react-helmet="true" name="keywords" content="sample, something"/><style id="gatsby-inlined-css">@import url(https://fonts.googleapis.com/css?family=Fjalla+One|Inconsolata|Roboto|Roboto+Slab);.header__container{background-color:#222;margin-bottom:1.45rem}.header__title{margin:0 auto;max-width:960px;padding:1.45rem 1.0875rem;font-family:Roboto}.header__title__text{color:#fff;text-decoration:none}code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{background:#073642}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.chip{background-color:#4a6fa5;padding:5px 10px;margin:10px 5px;color:#fff;width:auto;border-radius:10px;font-family:Inconsolata,monospace}.chip__container{margin-left:-5px}.blog-post{font-family:Roboto Slab}.blog-post__title{font-family:Fjalla One}.blog-post__date{font-family:Roboto}.blog-post-list{font-family:Roboto}.bio{float:right;width:300px;margin:0 0 20px 40px;padding:20px;background-color:#8cf;font-family:Roboto;font-size:16px}.bio img{width:100px;float:left;padding:3px;border:1px solid #888;margin:0 20px 20px 0}</style></head><body><div id="___gatsby"><div data-reactroot="" data-reactid="1" data-react-checksum="318835378"><!-- react-empty: 2 --><div class="header__container" data-reactid="3"><div class="header__title" data-reactid="4"><h1 style="margin:0;" data-reactid="5"><a class="header__title__text" href="/onCoding/" data-reactid="6">Brian Boyko (On Coding)</a></h1></div></div><div style="margin:0 auto;max-width:960px;padding:0px 1.0875rem 1.45rem;padding-top:0;" data-reactid="7"><div class="blog-post__container" data-reactid="8"><div class="blog-post" data-reactid="9"><div style="background-image:url(/onCoding/static/defaultImage-bf9d9895bd7ec25009144b0f166399c4.jpg);background-size:cover;height:auto;margin-bottom:40px;" data-reactid="10"><div style="color:white;padding:150px 20px 20px 20px;background:rgba(0, 0, 0, 0.3);" data-reactid="11"><h1 class="blog-post__title" data-reactid="12">Shooting from the Hip (without shooting yourself in the foot.)</h1><h2 class="blog-post__date" data-reactid="13">16 October, 2016</h2><span class="chip__container" data-reactid="14"><span class="chip" data-reactid="15"><span data-reactid="16">professional coding</span></span></span></div></div><div class="blog-post-content" data-reactid="17"><p>Sometimes, you just can't do things the "right" way.  Sometimes it just takes more time than you have, the site needs to go up literally yesterday, and to hell with best practices. </p>
<p>I don't like it, but sometimes it's a reality.  Case in point: I just helped @lessig with another site, this time raising money to fight for the <a href="https://canyouhearus.is">citizen-created and referendum-passed constitution in Iceland</a>.  Here's the problem - by the time we had finalized the plan, it was already the first week of October -- and the elections are to be held this <a href="https://en.wikipedia.org/wiki/Icelandic_parliamentary_election,_2016">October 29th</a>.  </p>
<p>Parliamentary systems move fast, that's one of the reasons I like 'em - but in this case, they needed a crowdfunding website up <em>now</em> and there was no time for my normal cautious "test-then-code-then-test-then-code" methodology. </p>
<p>So, how do you do that? When you have to take on technical debt, how do you go about taking on the least amount of it? </p>
<p>Even though you're not writing unit tests now, you need to assume you'll be writing unit tests in the future.  Because it's not just about having tests - testable code is easier to understand and reason about.  Writing tests encourages you to create loosely coupled code. In this case, you can get some of the effect without the cause, simply by keeping in mind: "When I unit test this, how would I want it organized?"  </p>
<p>This isn't as good as the real thing, of course.  I'm looking over my code - code that has made it into production - and realized there were places I should have used dependency injection instead of importing directly to a file. Like this: </p>
<div class="gatsby-highlight" data-language="javascript">
      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">//this is the bad way.  </span>
<span class="token keyword">import</span> mongodb <span class="token keyword">from</span> <span class="token string">'mongodb'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> MongoClient <span class="token operator">=</span> mongodb<span class="token punctuation">.</span>MongoClient<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">MONGO_URL</span> <span class="token operator">=</span> <span class="token string">'mongodb://someURL.com'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">connectToMongo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  MongoClient<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token constant">MONGO_URL</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> db<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
      </div>
<p>The problem is that now if i want to test connectToMongo(), I actually have to connect to the real database.  And for the most part, I don't want to do that. What I really should have done was something like this: </p>
<div class="gatsby-highlight" data-language="javascript">
      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">//this is a better way.  </span>
<span class="token keyword">import</span> mongodb <span class="token keyword">from</span> <span class="token string">'mongodb'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> MongoClient <span class="token operator">=</span> mongodb<span class="token punctuation">.</span>MongoClient<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">MONGO_URL</span> <span class="token operator">=</span> <span class="token string">'mongodb://someURL.com'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span>injections <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  connectToMongo<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> client <span class="token operator">=</span> injections<span class="token punctuation">.</span>client <span class="token operator">||</span> MongoClient<span class="token punctuation">;</span>
    client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token constant">MONGO_URL</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> db<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
      </div>
<p>Or something along those lines.  Main thing is that I'm importing a lot of files directly - and not just from third party libraries, but also my own code as well.  TDD would have caught this anti-pattern. Now it's going to be a messy refactor.  </p>
<p>But that said, I also made some smart decisions too. One key feature of the site was multilingual support.  Instead of hardcoding in key phrases, one of the ways I was able to approach this was by creating data objects for every possible phrase on the site and keeping them in a seperate "text" directory.  </p>
<p>For example, this is my "text/labels.js" file.  </p>
<div class="gatsby-highlight" data-language="javascript">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  donate<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token constant">EN</span><span class="token punctuation">:</span> <span class="token string">"Donate"</span><span class="token punctuation">,</span>
    <span class="token constant">IS</span><span class="token punctuation">:</span> <span class="token string">"Styðja"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  home<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token constant">EN</span><span class="token punctuation">:</span> <span class="token string">"Home"</span><span class="token punctuation">,</span>
    <span class="token constant">IS</span><span class="token punctuation">:</span> <span class="token string">"Heim"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  about<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token constant">EN</span><span class="token punctuation">:</span> <span class="token string">"About"</span><span class="token punctuation">,</span>
    <span class="token constant">IS</span><span class="token punctuation">:</span> <span class="token string">"Um"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  theConstitution<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token constant">EN</span><span class="token punctuation">:</span> <span class="token string">"The Constitution"</span><span class="token punctuation">,</span>
    <span class="token constant">IS</span><span class="token punctuation">:</span> <span class="token string">"Stjórnarskráin"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  learn<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token constant">EN</span><span class="token punctuation">:</span> <span class="token string">"Learn"</span><span class="token punctuation">,</span>
    <span class="token constant">IS</span><span class="token punctuation">:</span> <span class="token string">"Læra"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  parties<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token constant">EN</span><span class="token punctuation">:</span> <span class="token string">"Parties"</span><span class="token punctuation">,</span>
    <span class="token constant">IS</span><span class="token punctuation">:</span> <span class="token string">"Flokkar"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
      </div>
<p>In Redux, I simply defined a reducer called "language," when then gets mapped to every component's props.  So when it came time to define the button texts, it was easy to switch up the languages - just send in "EN" for English, and "IS" for Icelandic.  </p>
<div class="gatsby-highlight" data-language="jsx">
      <pre class="language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MenuItem</span> <span class="token attr-name">primaryText</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>labels<span class="token punctuation">.</span>home<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>language<span class="token punctuation">]</span><span class="token punctuation">}</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MenuItem</span> <span class="token attr-name">primaryText</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>labels<span class="token punctuation">.</span>learn<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>language<span class="token punctuation">]</span><span class="token punctuation">}</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/learn<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MenuItem</span> <span class="token attr-name">primaryText</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>labels<span class="token punctuation">.</span>about<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>language<span class="token punctuation">]</span><span class="token punctuation">}</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/about<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MenuItem</span> <span class="token attr-name">primaryText</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>labels<span class="token punctuation">.</span>theConstitution<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>language<span class="token punctuation">]</span><span class="token punctuation">}</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/constitution<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MenuItem</span> <span class="token attr-name">primaryText</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>labels<span class="token punctuation">.</span>parties<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>language<span class="token punctuation">]</span><span class="token punctuation">}</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/parties<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre>
      </div>
<p>By factoring out the actual content of the text from the rest of the site, it also made it easier for Icelandic non-technical team members to go in and insert the correct Icelandic in the right areas, without having to wade through tons of JS or JSX code.  It worked out brilliantly.  </p>
<p>Another way to uncouple code was by using inline styles.  While some designers still swear by SASS and LESS, the truth is that since we're already abstracting our websites into itty bitty pieces (on purpose), it doesn't make a whole lot of sense in my view, to keep style separate from the content -- especially when the same component can be used with different styles, simply by passing in props in React. Having the styles in the same file as the component itself really helps narrow down those pesky CSS bugs.  </p>
<p>The big limitation of inline styles, however, is that CSS and SASS support some features that aren't provided for in inline styles.  However, the Aphrodite library removes that limitation - so I used it.  </p>
<p>I'm happy with the way the site worked out, though it's a bit embarrassing to have something on my public github without unit test coverage. In the meantime, I'll add what tests I can, now that the site's main requirements have been met, and probably will go over and refactor after the Icelandic elections so that I can use this as a portfolio piece.  </p></div></div></div></div></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-c4f76d6e4cae8f6a822c.js","122212659448958":"component---src-templates-blog-template-js-3c042b543a488014fe7b.js","162898551421021":"component---src-pages-404-js-4503918ea3a16cfcdb75.js","35783957827783":"component---src-pages-index-js-05222a304816a819be01.js","218538773642512":"component---src-pages-page-2-js-1d4f0f19c1c44398ab65.js","60335399758886":"path----a80995809b8403e73bc5.js","168224806347839":"path---blog-typescript-i-get-it-393f86b95f5fbbf16dba.js","271492005434849":"path---blog-getters-and-setters-antipattern-18b1fe5db119865f09f1.js","184270320657383":"path---blog-private-and-protected-f465c1e73a55aa84c0d5.js","163844919532138":"path---blog-react-before-vue-7d84d820f549bab823e8.js","236448225686559":"path---blog-typescript-i-dont-get-it-f2a2e94ba1fb67c5624d.js","262036473486485":"path---blog-css-in-js-seperate-concerns-4d61a97b495d9014ea41.js","115491676190894":"path---blog-stupid-redux-tricks-6a85f059e0cdba2cd874.js","258654615034557":"path---blog-react-is-just-a-view-9894d9dd8342c7528124.js","49926254253336":"path---blog-currying-thinking-with-portals-fafa7d36257c92497632.js","41763247558397":"path---blog-d-3-in-react-53c5222d557bc67a1a70.js","220485664280490":"path---blog-c-live-dangerously-303ff7241a42df80ea0c.js","92893447782357":"path---blog-coding-on-paper-ed89352d00fe5fc68114.js","31428463216379":"path---blog-the-hip-ae7896d9acf4cd9e06e7.js","21394539151705":"path---blog-interestinglinks-1-39fc1daba0812b9e5a47.js","227515882628393":"path---blog-video-hack-reactor-1-1eaa58564ea41c872c83.js","280364320100666":"path---blog-cool-tools-e7f357ba59a5a24e19ad.js","261444995959908":"path---blog-random-redux-thoughts-b093ef55d6a6a9a9f671.js","16873448567208":"path---blog-redux-mobx-de8eebec133ae7f31479.js","69855552298772":"path---blog-the-other-side-6217a2f560777d96b2d9.js","144584405630298":"path---blog-git-and-subversion-a31508d88818ad1c455d.js","252476015291409":"path---blog-working-with-dynamic-type-3757cff52b99c84ecc1a.js","121292126702233":"path---blog-why-redux-a4fd03760e23debd5366.js","157254306246868":"path---blog-doing-it-right-vs-doing-it-fast-07f456f10bb0ebfbfc9c.js","254022195166212":"path---404-a0e39f21c11f6a62c5ab.js","142629428675168":"path---index-63250777b5c4e2537ece.js","135728916539164":"path---page-2-a0e39f21c11f6a62c5ab.js","178698757827068":"path---404-html-a0e39f21c11f6a62c5ab.js","114276838955818":"component---src-layouts-index-js-0e6e7990ee8dd50dc3f2.js"}/*]]>*/</script><script>/*<![CDATA[*/["/onCoding/commons-8dcba3f9452ce054e0e3.js","/onCoding/app-c4f76d6e4cae8f6a822c.js","/onCoding/path---blog-the-hip-ae7896d9acf4cd9e06e7.js","/onCoding/component---src-templates-blog-template-js-3c042b543a488014fe7b.js","/onCoding/component---src-layouts-index-js-0e6e7990ee8dd50dc3f2.js"].forEach(function(s){document.write('<script src="'+s+'" defer></'+'script>')})/*]]>*/</script></body></html>